# ๐ Deployment Files

ุงู ูพูุดู ุดุงูู ุชูุงู ูุงูโูุง ูุงุฒู ุจุฑุง deploy ู ุฑุงูโุงูุฏุงุฒ ุณุณุชู ูพุฑุฏุงุฒุด ูุฏู ูพุดุฑู ุงุณุช.

---

## ๐ฏ ฺฉุฏูู ุฑุงูููุง ุฑู ุจุฎูููุ

### ๐ ุชุงุฒู ฺฉุงุฑ ูุณุช ู ุชุง ุญุงูุง ุจุง SSH ฺฉุงุฑ ูฺฉุฑุฏุ
๐ **ุดุฑูุน ฺฉู ุงุฒ:** [`BEGINNER_GUIDE.md`](./BEGINNER_GUIDE.md)

### โก ูโุฎูุง ุณุฑุน ุฑุงูโุงูุฏุงุฒ ฺฉูุ
๐ **ุจุจู:** [`QUICK_START.md`](./QUICK_START.md) - ุชูุงู ุฏุณุชูุฑุงุช ุฏุฑ ฺฉ ุตูุญู

### ๐๏ธ ูโุฎูุง MongoDB ุฑู ุฑู ุณุฑูุฑ ูุตุจ ฺฉูุ
๐ **ุฑุงูููุง:** [`MONGODB_SETUP.md`](./MONGODB_SETUP.md) - ูุตุจ ู ุชูุธู ฺฉุงูู MongoDB

### ๐จ ูโุฎูุง ูพูู ูุฏุฑุช (CMS) ุฑู ูู deploy ฺฉูุ
๐ **ุฑุงูููุง:** [`CMS_DEPLOYMENT.md`](./CMS_DEPLOYMENT.md) - ุฑุงูโุงูุฏุงุฒ ฺฉุงูู CMS

### ๐ ููโุฏูู ูุงู .env ุฑู ฺุทูุฑ ุจุณุงุฒุ
๐ **ุฑุงูููุง:** [`ENV_SETUP_GUIDE.md`](./ENV_SETUP_GUIDE.md) - ููู ฺุฒ ุฏุฑุจุงุฑู .env

### ๐ ูโุฎูุง SSL ุฑุงฺฏุงู ูุตุจ ฺฉูุ
๐ **ุจุจู:** [`SSL_SETUP_GUIDE.md`](./SSL_SETUP_GUIDE.md) - ุฑุงูููุง ฺฉุงูู Let's Encrypt

### ๐ง Developer ูุณุช ู ูโุฎูุง ุฌุฒุฆุงุช ูู ุฑู ุจุฏููุ
๐ **ูุทุงูุนู ฺฉู:** [`DEPLOYMENT_GUIDE.md`](./DEPLOYMENT_GUIDE.md) - ุฑุงูููุง ฺฉุงูู ุชฺฉูฺฉุงู

---

## ๐ ูุญุชูุงุช

### 1. **MONGODB_SETUP.md** ๐๏ธ (ุฌุฏุฏ!)
ุฑุงูููุง ฺฉุงูู ูุตุจ ู ุชูุธู MongoDB ุฏุฑ ุณุฑูุฑ.

**ุดุงูู:**
- ูุตุจ MongoDB 7.0 ุฏุฑ Ubuntu
- ุชูุธูุงุช ุงููุช ู Authentication
- ุงุฌุงุฏ ฺฉุงุฑุจุฑ ู Database ุฌุฏุงฺฏุงูู ุจุฑุง ูุฑ ูพุฑูฺู
- ุชูุธู ุฏุณุชุฑุณ ุงุฒ ุฑุงู ุฏูุฑ
- Backup ู Restore
- ุนุจโุงุจ ู Monitoring

**ุจุฑุง ฺู ฺฉุณ:**
- ฺฉุณุงู ฺฉู ูโุฎูุงููุฏ MongoDB ุฑุง ุฑู ุณุฑูุฑ ุฎูุฏุดุงู ูุตุจ ฺฉููุฏ
- ฺฉุณุงู ฺฉู ูุงุฒ ุจู database ุฌุฏุงฺฏุงูู ุจุฑุง CMS ุฏุงุฑูุฏ

**ุงุณุชูุงุฏู:**
```bash
cat deploy/MONGODB_SETUP.md
```

---

### 2. **CMS_DEPLOYMENT.md** ๐จ (ุฌุฏุฏ!)
ุฑุงูููุง ฺฉุงูู deploy ฺฉุฑุฏู ูพูู ูุฏุฑุช (CMS) ุฏุฑ ููุงู ุณุฑูุฑ.

**ุดุงูู:**
- ูุนูุงุฑ ุณุณุชู (Main Site + CMS ุฏุฑ ฺฉ ุณุฑูุฑ)
- Deploy ูพุฑูฺู CMS ุฏุฑ ูพูุฑุช ุฌุฏุงฺฏุงูู
- ุชูุธู database ุฌุฏุงฺฏุงูู ุจุฑุง CMS
- ุชูุธู Nginx ุจุฑุง subdomain
- ูุฏุฑุช ุจุง PM2
- ุนุจโุงุจ

**ุจุฑุง ฺู ฺฉุณ:**
- ฺฉุณุงู ฺฉู ูโุฎูุงููุฏ ูพูู ูุฏุฑุช ุฑุง ูู deploy ฺฉููุฏ
- ฺฉุณุงู ฺฉู ุงุฒ ฺฉ ุณุฑูุฑ ุจุฑุง ฺูุฏ ูพุฑูฺู ุงุณุชูุงุฏู ูโฺฉููุฏ

**ุงุณุชูุงุฏู:**
```bash
cat deploy/CMS_DEPLOYMENT.md
```

---

### 3. **BEGINNER_GUIDE.md** ๐
ุฑุงูููุง ฺฉุงูู ุจุฑุง ูุจุชุฏุงู ฺฉู ูฺ ุชุฌุฑุจูโุง ุจุง SSH ูุฏุงุฑู.

**ุดุงูู:**
- ุขููุฒุด ุงุชุตุงู ุจู ุณุฑูุฑ ุจุง SSH (Windows ู Mac/Linux)
- ุชูุถุญ ูุฏู ุจู ูุฏู ูุฑ ุฏุณุชูุฑ
- ุฑุงูููุง ุณุงุฎุช ูุงู .env ุงุฒ ุตูุฑ
- ุนุจโุงุจ ูุดฺฉูุงุช ุฑุงุฌ
- ูฺฉุงุช ุงููุช ุณุงุฏู

**ุจุฑุง ฺู ฺฉุณ:**
- ฺฉุณุงู ฺฉู ุงููู ุจุงุฑ ุณุฑูุฑ ุฑุงูโุงูุฏุงุฒ ูโฺฉููุฏ
- ฺฉุณุงู ฺฉู ุจุง SSH ุขุดูุง ูุณุชูุฏ
- ฺฉุณุงู ฺฉู ูโุฎูุงููุฏ ูุฑ ูุฑุญูู ุฑู ุจู ุชูุตู ุจููููุฏ

**ุงุณุชูุงุฏู:**
```bash
cat deploy/BEGINNER_GUIDE.md
```

---

### 4. **QUICK_START.md** โก
ุฎูุงุตู ุชูุงู ุฏุณุชูุฑุงุช ุฏุฑ ฺฉ ุตูุญู - ููุท ฺฉูพ ู ูพุณุช!

**ุดุงูู:**
- ุชูุงู ุฏุณุชูุฑุงุช ุจู ุตูุฑุช ุขูุงุฏู ฺฉูพ
- ุจุฏูู ุชูุถุญุงุช ุงุถุงู
- ููุงุณุจ ุจุฑุง ูุฑุงุฌุนู ุณุฑุน

**ุจุฑุง ฺู ฺฉุณ:**
- ฺฉุณุงู ฺฉู ูุจูุง ุณุฑูุฑ ุฑุงูโุงูุฏุงุฒ ฺฉุฑุฏู
- ฺฉุณุงู ฺฉู ููุท ุจู ุฏุณุชูุฑุงุช ูุงุฒ ุฏุงุฑูุฏ

**ุงุณุชูุงุฏู:**
```bash
cat deploy/QUICK_START.md
```

---

### 5. **ENV_SETUP_GUIDE.md** ๐
ุฑุงูููุง ฺฉุงูู ุณุงุฎุช ู ูุฏุฑุช ูุงู .env

**ุดุงูู:**
- ุชูุถุญ .env ฺู ู ฺุฑุง ูุงุฒูู
- ุฑุงูููุง ุฏุฑุงูุช ุงุทูุงุนุงุช ุงุฒ iranServer
- ุชููุฏ AUTH_SECRET
- ุชุณุช ู ุนุจโุงุจ .env
- ูฺฉุงุช ุงููุช

**ุจุฑุง ฺู ฺฉุณ:**
- ฺฉุณุงู ฺฉู ููโุฏูููุฏ .env ฺู
- ฺฉุณุงู ฺฉู ูุงุฒ ุจู ุฑุงูููุง ุจุฑุง ูพุฑ ฺฉุฑุฏู .env ุฏุงุฑูุฏ

**ุงุณุชูุงุฏู:**
```bash
cat deploy/ENV_SETUP_GUIDE.md
```

---

### 6. **SSL_SETUP_GUIDE.md** ๐
ุฑุงูููุง ฺฉุงูู ูุตุจ ฺฏูุงู SSL ุฑุงฺฏุงู ุจุง Let's Encrypt

**ุดุงูู:**
- ุชูุถุญ SSL ู ุงููุช ุงูู
- ูุตุจ Nginx
- ุชูุธู DNS
- ุฏุฑุงูุช ฺฏูุงู ุฑุงฺฏุงู ุงุฒ Let's Encrypt
- ุชูุธู HTTPS
- ุชูุฏุฏ ุฎูุฏฺฉุงุฑ
- ุชุณุช ู ุนุจโุงุจ
- ูฺฉุงุช ุงููุช

**ุจุฑุง ฺู ฺฉุณ:**
- ฺฉุณุงู ฺฉู ูโุฎูุงููุฏ ุณุงุชุดูู HTTPS ุฏุงุดุชู ุจุงุดู
- ฺฉุณุงู ฺฉู ููู ุณุจุฒ ุฏุฑ ูุฑูุฑฺฏุฑ ูโุฎูุงููุฏ
- ฺฉุณุงู ฺฉู ุงููู ุจุงุฑ SSL ูุตุจ ูโฺฉููุฏ

**ุงุณุชูุงุฏู:**
```bash
cat deploy/SSL_SETUP_GUIDE.md
```

---

### 7. **DEPLOYMENT_GUIDE.md** ๐ (ุชฺฉูฺฉุงู)
ุฑุงูููุง ฺฉุงูู ู ฺฏุงูโุจูโฺฏุงู ุจุฑุง deployment ุณุณุชู.

**ุดุงูู:**
- ูุนูุงุฑ ุณุณุชู
- ูพุดโูุงุฒูุง
- ุขูุงุฏูโุณุงุฒ ุณุฑูุฑ
- ูุตุจ dependencies
- ุชูุธู Object Storage (iranServer)
- ุฑุงูโุงูุฏุงุฒ Worker
- ุชุณุช ู Monitoring
- ุนุจโุงุจ
- ูฺฏูุฏุงุฑ

**ุจุฑุง ฺู ฺฉุณ:**
- Developers ุจุง ุชุฌุฑุจู
- ฺฉุณุงู ฺฉู ุฌุฒุฆุงุช ูู ูโุฎูุงููุฏ

**ุงุณุชูุงุฏู:**
```bash
cat deploy/DEPLOYMENT_GUIDE.md
```

---

### 8. **SERVER_SETUP.md** โ
ฺฺฉโูุณุช ฺฉุงูู ูุตุจ ู ุชูุธู ุณุฑูุฑ.

**ุดุงูู:**
- ูุตุจ FFmpeg
- ูุตุจ Node.js 20
- ูุตุจ Docker
- ุณุงุฎุช ุฏุงุฑฺฉุชูุฑโูุง ูููุช
- ุฑุงูโุงูุฏุงุฒ Worker (3 ุฑูุด)
- ุชุณุช ุณุณุชู
- ุชูุธูุงุช Production

**ุงุณุชูุงุฏู:**
```bash
# ูุดุงูุฏู ฺฺฉโูุณุช
cat deploy/SERVER_SETUP.md
```

---

### 9. **setup-ubuntu.sh** ๐
ุงุณฺฉุฑูพุช ุฎูุฏฺฉุงุฑ ูุตุจ dependencies ุฏุฑ Ubuntu 20.04+.

**ูุตุจ ูโฺฉูุฏ:**
- FFmpeg 4.2+
- Node.js 20 LTS
- Docker (ุงุฎุชุงุฑ)
- ุงุจุฒุงุฑูุง ฺฉูฺฉ (git, curl, wget, etc.)

**ุงุณุชูุงุฏู:**
```bash
# ุฑู ุณุฑูุฑ ุงุฌุฑุง ฺฉูุฏ
sudo bash deploy/setup-ubuntu.sh
```

**ุฒูุงู ุงุฌุฑุง:** ุญุฏูุฏ 5-10 ุฏููู

---

### 10. **systemd-worker.service** โ๏ธ
ูุงู systemd service ุจุฑุง ุงุฌุฑุง Worker ุจู ุตูุฑุช service.

**ูฺฺฏโูุง:**
- ุงุฌุฑุง ุฎูุฏฺฉุงุฑ ุฏุฑ startup
- Restart ุฎูุฏฺฉุงุฑ ุฏุฑ ุตูุฑุช ุฎุทุง
- ูุฏุฑุช ุจุง systemctl
- Logging ุจุง journald

**ุงุณุชูุงุฏู:**
```bash
# ฺฉูพ ฺฉุฑุฏู ูุงู
sudo cp deploy/systemd-worker.service /etc/systemd/system/pishro-worker.service

# ุฑุงูโุงูุฏุงุฒ service
sudo systemctl daemon-reload
sudo systemctl enable pishro-worker
sudo systemctl start pishro-worker

# ุจุฑุฑุณ ูุถุนุช
sudo systemctl status pishro-worker

# ูุดุงูุฏู logs
sudo journalctl -u pishro-worker -f
```

---

## ๐ฏ ุดุฑูุน ุณุฑุน

### ฺฏุงู 1: ุขูุงุฏูโุณุงุฒ ุณุฑูุฑ
```bash
# ุงุฌุฑุง ุงุณฺฉุฑูพุช ูุตุจ ุฎูุฏฺฉุงุฑ
sudo bash deploy/setup-ubuntu.sh
```

### ฺฏุงู 2: ุชูุธู ูพุฑูฺู
```bash
# Clone repository
git clone <repo-url> /opt/pishro
cd /opt/pishro

# ูุตุจ dependencies
npm install

# ุงุฌุงุฏ .env
cp .env.example .env
nano .env  # ุชูุธู ูุชุบุฑูุง ูุญุท

# Build
npm run build
```

### ฺฏุงู 3: ุฑุงูโุงูุฏุงุฒ Worker

**ุฑูุด A: Docker Compose (ุชูุตู ูโุดูุฏ)**
```bash
docker compose up -d video-processor
docker compose logs -f video-processor
```

**ุฑูุด B: systemd Service**
```bash
sudo cp deploy/systemd-worker.service /etc/systemd/system/pishro-worker.service
sudo systemctl enable --now pishro-worker
sudo journalctl -u pishro-worker -f
```

**ุฑูุด C: ุงุฌุฑุง ุฏุณุช (ููุท ุชุณุช)**
```bash
npx tsx scripts/video-processor-worker.ts
```

### ฺฏุงู 4: ุชุณุช ุณุณุชู
```bash
npx tsx scripts/test-video-system.ts
```

---

## ๐ ฺฺฉโูุณุช Deployment

- [ ] ุณุฑูุฑ Ubuntu 20.04+ ุขูุงุฏู ุงุณุช
- [ ] FFmpeg ูุตุจ ุดุฏู (ุงุฌุฑุง `setup-ubuntu.sh`)
- [ ] Node.js 20 ูุตุจ ุดุฏู
- [ ] Docker ูุตุจ ุดุฏู (ุงุฎุชุงุฑ)
- [ ] Repository clone ุดุฏู ุฏุฑ `/opt/pishro`
- [ ] ูุงู `.env` ุจุง ุงุทูุงุนุงุช ุตุญุญ ุณุงุฎุชู ุดุฏู
- [ ] Dependencies ูุตุจ ุดุฏู (`npm install`)
- [ ] Build ูููู ุจูุฏู (`npm run build`)
- [ ] Database ูุชุตู ุงุณุช
- [ ] Object Storage (iranServer S3) ุชูุธู ุดุฏู โณ
- [ ] Worker ุฏุฑ ุญุงู ุงุฌุฑุง ุงุณุช
- [ ] ุชุณุช ุณุณุชู ูููู ุจูุฏู (`test-video-system.ts`)
- [ ] Next.js app ุฏุฑ ุญุงู ุงุฌุฑุง ุงุณุช (`pm2` ุง `systemd`)

---

## ๐ ุงุทูุงุนุงุช ููุฑุฏ ูุงุฒ

### โ ุฏุฑ ุฏุณุชุฑุณ
- DATABASE_URL (MongoDB)
- AUTH_SECRET
- SMS credentials
- Payment gateway credentials

### โณ ูุงุฒ ุจู ุฏุฑุงูุช ุงุฒ **iranServer**
```env
S3_ENDPOINT="https://s3.iran-server.com"
S3_REGION="default"
S3_ACCESS_KEY_ID="???"
S3_SECRET_ACCESS_KEY="???"
S3_BUCKET_NAME="pishro-videos"
S3_PUBLIC_URL="???"
```

**ููุช ุงู ุงุทูุงุนุงุช ุฑุง ุฏุฑุงูุช ฺฉุฑุฏุฏ:**
1. ูุงู `.env` ุฑุง ูุฑุงุด ฺฉูุฏ
2. Worker ุฑุง restart ฺฉูุฏ
3. ฺฉ ูุฏู ุชุณุช ุขูพููุฏ ฺฉูุฏ
4. ูุฐุช ุจุจุฑุฏ! ๐

---

## ๐ ูพุดุชุจุงู

### ุฑุงูููุงูุง
1. **DEPLOYMENT_GUIDE.md** - ุฑุงูููุง ฺฉุงูู
2. **SERVER_SETUP.md** - ฺฺฉโูุณุช ูุตุจ

### ุนุจโุงุจ
```bash
# Worker logs (Docker)
docker compose logs -f video-processor

# Worker logs (systemd)
sudo journalctl -u pishro-worker -f

# ุจุฑุฑุณ FFmpeg
ffmpeg -version

# ุชุณุช ุณุณุชู
npx tsx scripts/test-video-system.ts

# ุจุฑุฑุณ ูุถุง ุฏุณฺฉ
df -h
```

### ูุดฺฉูุงุช ุฑุงุฌ
| ูุดฺฉู | ุฑุงูโุญู |
|------|--------|
| Worker ุงุฌุฑุง ููโุดูุฏ | ุจุฑุฑุณ logs ู FFmpeg |
| ุฎุทุง ุงุชุตุงู ุจู S3 | ุจุฑุฑุณ credentials ุฏุฑ `.env` |
| ุฎุทุง FFmpeg | `sudo apt-get install --reinstall ffmpeg` |
| ูุถุง ุฏุณฺฉ ูพุฑ | ูพุงฺฉุณุงุฒ `/tmp/video-processing` |

---

## ๐ ฺฏุฒุงุฑุด ูุดฺฉู

ุงฺฏุฑ ูุดฺฉู ูพุด ุขูุฏ:
1. ูุงฺฏโูุง ุฎุทุง ุฑุง ุจุฑุฑุณ ฺฉูุฏ
2. ุงุณฺฉุฑูพุช ุชุณุช ุฑุง ุงุฌุฑุง ฺฉูุฏ
3. ุจู GitHub Issues ูุฑุงุฌุนู ฺฉูุฏ

---

**ูููู ุจุงุดุฏ! ๐**
