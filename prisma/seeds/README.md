# ๐ฑ ุฑุงูููุง Seed ุงุทูุงุนุงุช ูพุงฺฏุงูโุฏุงุฏู

ุงู ูุณุชูุฏุงุช ุฑุงูููุง ฺฉุงูู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุงุณฺฉุฑูพุชโูุง seed ูพุฑูฺู Pishro ุงุณุช.

## ๐ ููุฑุณุช ูุทุงูุจ

- [ูุตุจ ู ูพุดโูุงุฒูุง](#ูุตุจ-ู-ูพุด-ูุงุฒูุง)
- [ุณุงุฎุชุงุฑ ูุงูโูุง](#ุณุงุฎุชุงุฑ-ูุงู-ูุง)
- [ูุญูู ุงุฌุฑุง](#ูุญูู-ุงุฌุฑุง)
- [ูุชุบุฑูุง ูุญุท](#ูุชุบุฑูุง-ูุญุท)
- [ูุฏูโูุง ุฏุงุฏู](#ูุฏู-ูุง-ุฏุงุฏู)
- [ูฺฺฏโูุง](#ูฺฺฏ-ูุง)
- [ุฑูุน ูุดฺฉูุงุช](#ุฑูุน-ูุดฺฉูุงุช)

---

## ูุตุจ ู ูพุดโูุงุฒูุง

### ูพุดโูุงุฒูุง

- Node.js ูุณุฎู 18 ุง ุจุงูุงุชุฑ
- npm ุง yarn
- MongoDB (ูุญู ุง ุงุจุฑ)
- ูุชุบุฑ ูุญุท `DATABASE_URL` ุชูุธู ุดุฏู

### ูุตุจ ูุงุจุณุชฺฏโูุง

```bash
npm install
# ุง
yarn install
```

### ูุงุจุณุชฺฏโูุง ููุฑุฏ ูุงุฒ ุจุฑุง seed

ุงุณฺฉุฑูพุชโูุง seed ุจู ูพฺฉุฌโูุง ุฒุฑ ูุงุฒ ุฏุงุฑูุฏ:

```json
{
  "@prisma/client": "latest",
  "bcryptjs": "^2.4.3",
  "typescript": "^5.6.0",
  "ts-node": "^10.9.0"
}
```

ุงฺฏุฑ ูุตุจ ูุดุฏูโุงูุฏ:

```bash
npm install bcryptjs @types/bcryptjs
```

---

## ุณุงุฎุชุงุฑ ูุงูโูุง

```
prisma/
โโโ seeds/
    โโโ persian-data-generator.ts  # ุชููุฏ ฺฉููุฏู ุฏุงุฏูโูุง ูุงุฑุณ
    โโโ seed-categories.ts          # ุฏุณุชูโุจูุฏโูุง
    โโโ seed-tags.ts                # ุจุฑฺุณุจโูุง
    โโโ seed-users.ts               # ฺฉุงุฑุจุฑุงู
    โโโ seed-courses.ts             # ุฏูุฑูโูุง ุขููุฒุด
    โโโ seed-comments.ts            # ูุธุฑุงุช
    โโโ seed-quizzes.ts             # ุขุฒูููโูุง ู ุณูุงูุงุช
    โโโ seed-enrollments.ts         # ุซุจุชโูุงูโูุง
    โโโ seed-orders.ts              # ุณูุงุฑุดุงุช ู ุชุฑุงฺฉูุดโูุง
    โโโ seed-news.ts                # ุงุฎุจุงุฑ ู ููุงูุงุช
    โโโ seed-books.ts               # ฺฉุชุงุจโูุง ุฏุฌุชุงู
    โโโ seed-faqs.ts                # ุณูุงูุงุช ูุชุฏุงูู
    โโโ seed-pagecontent.ts         # ูุญุชูุง ุตูุญุงุช
    โโโ seed-newsletter.ts          # ูุดุชุฑฺฉู ุฎุจุฑูุงูู
    โโโ seed-all.ts                 # ุงุฌุฑุง ููู seedูุง
    โโโ README.md                   # ุงู ูุงู
```

---

## ูุญูู ุงุฌุฑุง

### ุงุฌุฑุง ุชูุงู Seedูุง

ุจุฑุง ุงุฌุฑุง ุชูุงู ุงุณฺฉุฑูพุชโูุง seed ุจู ุชุฑุชุจ ุตุญุญ:

```bash
npx ts-node prisma/seeds/seed-all.ts
```

ุง ูโุชูุงูุฏ ุฏุฑ `package.json` ุงุณฺฉุฑูพุช ุฒุฑ ุฑุง ุงุถุงูู ฺฉูุฏ:

```json
{
  "scripts": {
    "seed": "ts-node prisma/seeds/seed-all.ts",
    "seed:reset": "npm run db:reset && npm run seed"
  }
}
```

ุณูพุณ ุงุฌุฑุง ฺฉูุฏ:

```bash
npm run seed
```

### ุงุฌุฑุง Seed ุชฺฉ

ุจุฑุง ุงุฌุฑุง ฺฉ seed ุฎุงุต:

```bash
# ูุซุงู: ููุท Categories
npx ts-node prisma/seeds/seed-categories.ts

# ูุซุงู: ููุท Users
npx ts-node prisma/seeds/seed-users.ts
```

### ุฑุณุช ฺฉุฑุฏู ุฏุชุงุจุณ ู Seed ูุฌุฏุฏ

```bash
# ูพุงฺฉ ฺฉุฑุฏู ฺฉุงูู ุฏุชุงุจุณ
npx prisma db push --force-reset

# ุงุฌุฑุง ูุฌุฏุฏ seedูุง
npm run seed
```

---

## ูุชุบุฑูุง ูุญุท

### ุชูุธู DATABASE_URL

ูุงู `.env` ุฏุฑ ุฑุดู ูพุฑูฺู ุงุฌุงุฏ ฺฉูุฏ:

```env
# MongoDB Connection String
DATABASE_URL="mongodb://localhost:27017/pishro"

# ุง ุจุฑุง MongoDB Atlas
DATABASE_URL="mongodb+srv://username:password@cluster.mongodb.net/pishro"

# ูุญุท ุงุฌุฑุง (ุญุชูุงู development ุจุงุดุฏ)
NODE_ENV="development"
```

### ูุญุฏูุฏุชโูุง ุงููุช

โ๏ธ **ูุดุฏุงุฑ ุงููุช**: ุงุณฺฉุฑูพุชโูุง seed **ููุท ุฏุฑ ูุญุท development** ุงุฌุฑุง ูโุดููุฏ.

ุงฺฏุฑ `NODE_ENV=production` ุจุงุดุฏุ seed ุงุฌุฑุง ูุฎูุงูุฏ ุดุฏ ู ุฎุทุง ูโุฏูุฏ.

---

## ูุฏูโูุง ุฏุงุฏู

### ุชุฑุชุจ ุงุฌุฑุง Seedูุง

Seedูุง ุจู ุชุฑุชุจ ุฒุฑ ุงุฌุฑุง ูโุดููุฏ ุชุง ูุงุจุณุชฺฏโูุง ุฑุนุงุช ุดูุฏ:

1. **Categories** - ุฏุณุชูโุจูุฏโูุง ุงุตู (8 ุฏุณุชู)
2. **Tags** - ุจุฑฺุณุจโูุง (30 ุจุฑฺุณุจ)
3. **Users** - ฺฉุงุฑุจุฑุงู (1 admin + 50 user)
4. **Courses** - ุฏูุฑูโูุง ุขููุฒุด (40 ุฏูุฑู)
5. **Comments** - ูุธุฑุงุช (100 ูุธุฑ)
6. **Quizzes & Questions** - ุขุฒูููโูุง ู ุณูุงูุงุช (ุญุฏูุฏ 80 ุขุฒูููุ 800 ุณูุงู)
7. **Enrollments** - ุซุจุชโูุงูโูุง (ูุชุบุฑ ุจุฑ ุงุณุงุณ ฺฉุงุฑุจุฑุงู)
8. **Orders & Transactions** - ุณูุงุฑุดุงุช (ูุชุบุฑ)
9. **News Articles** - ููุงูุงุช ุฎุจุฑ (30 ููุงูู)
10. **Digital Books** - ฺฉุชุงุจโูุง ุฏุฌุชุงู (25 ฺฉุชุงุจ)
11. **FAQs** - ุณูุงูุงุช ูุชุฏุงูู (40 ุณูุงู)
12. **Page Content** - ูุญุชูุง ุตูุญุงุช (ุจุฑุง ูุฑ ุฏุณุชู 4 ุจุฎุด)
13. **Newsletter** - ูุดุชุฑฺฉู ุฎุจุฑูุงูู (100 ูุดุชุฑฺฉ)

### ุชุนุฏุงุฏ ุฑฺฉูุฑุฏูุง

| ูุฏู                  | ุชุนุฏุงุฏ ุชูุฑุจ           |
| -------------------- | ---------------------- |
| Category             | 8                      |
| Tag                  | 30                     |
| User                 | 51 (1 admin + 50 user) |
| Course               | 40                     |
| Comment              | 100                    |
| Quiz                 | ~80                    |
| QuizQuestion         | ~800                   |
| Enrollment           | ~150-200               |
| Order                | ~50-100                |
| OrderItem            | ~100-200               |
| Transaction          | ~50-100                |
| NewsArticle          | 30                     |
| DigitalBook          | 25                     |
| FAQ                  | 40                     |
| PageContent          | ~32                    |
| NewsletterSubscriber | 100                    |

**ูุฌููุน ุชูุฑุจ: 1500-1700 ุฑฺฉูุฑุฏ**

---

## ูฺฺฏโูุง

### โ Idempotency (ูุงุจูุช ุงุฌุฑุง ูุฌุฏุฏ)

ุชูุงู seedูุง ุงุฒ `upsert` ุงุณุชูุงุฏู ูโฺฉููุฏุ ุจู ุงู ูุนู ฺฉู:

- ุงุฌุฑุง ูุฌุฏุฏ seed ุจุงุนุซ duplicate ููโุดูุฏ
- ุฑฺฉูุฑุฏูุง ููุฌูุฏ ุจูโุฑูุฒุฑุณุงู ูโุดููุฏ
- ุฑฺฉูุฑุฏูุง ุฌุฏุฏ ุงุถุงูู ูโุดููุฏ

### โ ุฏุงุฏูโูุง ูุงุฑุณ ูุงูุนโฺฏุฑุงุงูู

- ูุงูโูุง ูุงุฑุณ (ุงุณู ู ูุงูู)
- ุดูุงุฑู ุชููู ุงุฑุงู (ูุฑูุช: `09xxxxxxxxx`)
- ฺฉุฏ ูู 10 ุฑูู
- ุดูุงุฑู ฺฉุงุฑุช ู ุดุจุง
- ูุชูโูุง ูุงุฑุณ ุทุจุน ู ฺฉุงุฑุจุฑุฏ
- ููุถูุนุงุช ูุฑุชุจุท ุจุง ุจูุฑุณุ ุงุฑุฒ ุฏุฌุชุงู ู ุณุฑูุงูโ ฺฏุฐุงุฑ

### โ Deterministic (ูุทุน ู ูุงุจู ูพุดโุจู)

- ุงุณุชูุงุฏู ุงุฒ seed ุซุงุจุช (`12345`) ุจุฑุง ุชููุฏ ุชุตุงุฏู
- ูุฑ ุจุงุฑ ุงุฌุฑุงุ ุฏุงุฏูโูุง ฺฉุณุงู ุชููุฏ ูโุดูุฏ
- ููุงุณุจ ุจุฑุง ุชุณุช ู ุชูุณุนู

### โ ุฑูุงุจุท ุตุญุญ ุจู ูุฏูโูุง

- ุงุฑุชุจุงุท ุตุญุญ Category โ Course
- ุงุฑุชุจุงุท Many-to-Many ุจู Course ู Tag
- ุงุฑุชุจุงุท User โ Enrollment โ Course
- ุงุฑุชุจุงุท Order โ OrderItem โ Course

---

## ุฑูุน ูุดฺฉูุงุช

### ุฎุทุง "Cannot run seeds in production"

**ุนูุช**: `NODE_ENV` ุจุฑ ุฑู `production` ุชูุธู ุดุฏู

**ุฑุงูโุญู**:

```bash
# ุฏุฑ ุชุฑููุงู
export NODE_ENV=development

# ุง ุฏุฑ ูุงู .env
NODE_ENV=development
```

### ุฎุทุง "Please seed X first"

**ุนูุช**: ุณุน ฺฉุฑุฏุฏ ฺฉ seed ุฑุง ูุณุชูู ุงุฌุฑุง ฺฉูุฏ ฺฉู ุจู ูุฏู ุฏฺฏุฑ ูุงุจุณุชู ุงุณุช

**ุฑุงูโุญู**: ุงุฒ `seed-all.ts` ุงุณุชูุงุฏู ฺฉูุฏ ุง seedูุง ุฑุง ุจู ุชุฑุชุจ ุตุญุญ ุงุฌุฑุง ฺฉูุฏ

### ุฎุทุง "Unique constraint failed"

**ุนูุช**: ุฑฺฉูุฑุฏ ุจุง slug ุง phone ุชฺฉุฑุงุฑ ูุฌูุฏ ุฏุงุฑุฏ

**ุฑุงูโุญู**:

```bash
# ูพุงฺฉ ฺฉุฑุฏู ุฏุชุงุจุณ ู ุดุฑูุน ูุฌุฏุฏ
npx prisma db push --force-reset
npm run seed
```

### ุฎุทุง Connection ุจู MongoDB

**ุนูุช**: `DATABASE_URL` ุงุดุชุจุงู ุง MongoDB ุฏุฑ ุฏุณุชุฑุณ ูุณุช

**ุฑุงูโุญู**:

1. ุจุฑุฑุณ ฺฉูุฏ MongoDB ุฏุฑ ุญุงู ุงุฌุฑุงุณุช
2. `DATABASE_URL` ุฏุฑ `.env` ุฑุง ฺฺฉ ฺฉูุฏ
3. ุงุชุตุงู ุฑุง ุชุณุช ฺฉูุฏ:
   ```bash
   npx prisma db push
   ```

### ุฎุทุง "bcryptjs not found"

**ุฑุงูโุญู**:

```bash
npm install bcryptjs @types/bcryptjs
```

### ุฎุทุง TypeScript

**ุฑุงูโุญู**:

```bash
npm install -D typescript ts-node @types/node
```

---

## ุงุทูุงุนุงุช ูุฑูุฏ ูพุดโูุฑุถ

ูพุณ ุงุฒ seedุ ูโุชูุงูุฏ ุจุง ุงุทูุงุนุงุช ุฒุฑ ูุงุฑุฏ ุณุณุชู ุดูุฏ:

### ุงุฏูู

- **ุดูุงุฑู ุชููู**: `09123456789`
- **ุฑูุฒ ุนุจูุฑ**: `Admin@123`
- **ููุด**: ADMIN

### ฺฉุงุฑุจุฑุงู ุนุงุฏ

- **ุดูุงุฑู ุชููู**: ูุฑ ุดูุงุฑู ุชููุฏ ุดุฏู ุชูุณุท seed
- **ุฑูุฒ ุนุจูุฑ**: `User@123`
- **ููุด**: USER

---

## ุชูุตูโูุง ุงููุช

1. **ูุฑฺฏุฒ ุฏุฑ production ุงุฌุฑุง ูฺฉูุฏ** - ููุท ุจุฑุง development
2. **ุฑูุฒูุง ูพุดโูุฑุถ ุฑุง ุชุบุฑ ุฏูุฏ** - ูุจู ุงุฒ ุงุณุชูุฑุงุฑ
3. **DATABASE_URL ุฑุง ูุญุงูุธุช ฺฉูุฏ** - `.env` ุฑุง ุฏุฑ `.gitignore` ูุฑุงุฑ ุฏูุฏ
4. **ุฏุณุชุฑุณ MongoDB ุฑุง ูุญุฏูุฏ ฺฉูุฏ** - IP whitelisting ุงุณุชูุงุฏู ฺฉูุฏ

---

## ุณูุงูุงุช ูุชุฏุงูู

**ุณ: ฺูุฏุฑ ุทูู ูโฺฉุดุฏ ุชุง seedูุง ุงุฌุฑุง ุดููุฏุ**
ุฌ: ุจุณุชู ุจู ุณุฑุนุช ุณุณุชูุ ูุนูููุงู 10-30 ุซุงูู

**ุณ: ุขุง ูโุชูุงูู ุชุนุฏุงุฏ ุฑฺฉูุฑุฏูุง ุฑุง ุชุบุฑ ุฏููุ**
ุฌ: ุจููุ ุฏุฑ ูุฑ ูุงู seed ูุชุบุฑูุง ูุงููุฏ `USER_COUNT` ุง `COURSE_COUNT` ูุฌูุฏ ุฏุงุฑุฏ

**ุณ: ุขุง seedูุง ุฏุงุฏูโูุง ููุฌูุฏ ุฑุง ูพุงฺฉ ูโฺฉููุฏุ**
ุฌ: ุฎุฑุ seedูุง ุงุฒ upsert ุงุณุชูุงุฏู ูโฺฉููุฏ ู ููุท ุจูโุฑูุฒุฑุณุงู ุง ุงุถุงูู ูโฺฉููุฏ

**ุณ: ฺุทูุฑ seed ุฎุงุต ุฑุง ุบุฑูุนุงู ฺฉููุ**
ุฌ: ุฏุฑ `seed-all.ts` ุฎุท ูุฑุจูุท ุจู ุขู seed ุฑุง ฺฉุงููุช ฺฉูุฏ

---

## ูพุดุชุจุงู

ุฏุฑ ุตูุฑุช ุจุฑูุฒ ูุดฺฉู:

1. Log ูุง ุฎุฑูุฌ ุฑุง ุจุฑุฑุณ ฺฉูุฏ
2. ูุทูุฆู ุดูุฏ ุชูุงู ูุงุจุณุชฺฏโูุง ูุตุจ ุดุฏูโุงูุฏ
3. `DATABASE_URL` ู `NODE_ENV` ุฑุง ฺฺฉ ฺฉูุฏ
4. MongoDB ุฑุง restart ฺฉูุฏ
5. ุฏุชุงุจุณ ุฑุง reset ฺฉุฑุฏู ู ุฏูุจุงุฑู seed ฺฉูุฏ

---

**ูุณุฎู**: 1.0.0
**ุชุงุฑุฎ ุจุฑูุฒุฑุณุงู**: 2025-01-09
**ููุงุณุจ ุจุฑุง**: Next.js 15, Prisma (MongoDB), TypeScript

๐ฑ ูููู ุจุงุดุฏ!
